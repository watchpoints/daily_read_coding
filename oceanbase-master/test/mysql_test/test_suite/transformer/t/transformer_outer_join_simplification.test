--disable_query_log
set @@session.explicit_defaults_for_timestamp=off;
set foreign_key_checks=1;
--enable_query_log

#alter system set _enable_record_rollback_trans_log=false;

# schema
--disable_warnings
--disable_query_log
drop database if exists transformer;
create database transformer;
use transformer;
drop table if exists t1, t2, t3, t4, t1_temp, t2_temp, t3_temp, t4_temp, t5_temp, t6_temp, t7_temp, t8_temp, t9_temp, t10_temp, t11_temp, t12_temp, t13_temp, t14_temp, t15_temp, t16_temp;
--enable_warnings

create table t1(c1 int primary key, c2 int);
insert into t1 values (1, 1);
insert into t1 values (2, 5);
insert into t1 values (3, 2);
insert into t1 values (4, 6);
insert into t1 values (5, 4);
insert into t1 values (6, 7);

create table t2(c1 int primary key, c2 int, c3 varchar(32));
insert into t2 values (1, 1, 'o');
insert into t2 values (2, 5, 'c');
insert into t2 values (3, 5, 'b');
insert into t2 values (4, 6, 'o');
insert into t2 values (5, 7, 'd');
insert into t2 values (6, 8, 'c');

create table t3(c1 int primary key, c2 int, c3 varchar(32));
insert into t3 values (1, 2, '3');
insert into t3 values (2, 5, '4');
insert into t3 values (3, 6, '1');
insert into t3 values (4, 5, '1');
insert into t3 values (5, 5, '5');
insert into t3 values (6, 5, 'c');

create table t4(c1 int primary key, c2 int, c3 varchar(32));
insert into t4 values (1, 1, 'o');
insert into t4 values (2, 5, 'c');
insert into t4 values (3, 5, 'b');
insert into t4 values (4, 6, 'o');
insert into t4 values (5, 7, 'd');
insert into t4 values (6, 8, 'c');

create table t1_temp(a int, b int, c varchar(32), d int, e int);
create table t2_temp(a int primary key, b int);
create table t3_temp(a int, b int, c int, e varchar(32));
create table t4_temp(a int, b int, c int, d int, e varchar(32));
create table t5_temp(a int, b int, c int, d int, e varchar(32), f int, g int, h varchar(32));
create table t6_temp(a int, b int, c int, d int, e int, f int, g varchar(32));
create table t7_temp(a int, b int, c int, d int, e varchar(32), f int, g int, h varchar(32), i int, j int, k varchar(32));
create table t8_temp(a int, b int, c int, d int);
create table t9_temp(a int, b int, c int, d int, e varchar(32), f int, g int, h varchar(32), i int, j int); 
create table t10_temp(a int, b int, c int, d int, e varchar(32), f int, g int, h varchar(32), i int, j int, k varchar(32), l int, m int);
create table t11_temp(a int, b int);
create table t12_temp(a int);
create table t13_temp(a int, b int, c varchar(32), d int, e int, f varchar(32));
create table t14_temp(a int, b int, c int);
create table t15_temp(a int, b int, c int, d int, e varchar(32), f int, g int, h varchar(32), i int, j int, k varchar(32), l int, m int, n varchar(32));
create table t16_temp(a int, b int, c varchar(32), d int, e int, f varchar(32));

sleep 3;
--enable_warnings
--enable_query_log
# schema END




set autocommit=0;

##case arithmatic and basic compare
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2);
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2);
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2));

rollback;
update t1 set c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 not between 1 and 2));
select stddev(c2) from t1;
rollback;

##case arithmatic and basic compare
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null);
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null);
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null));

rollback;
update t1 set c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (v.c2 <=> null));
select stddev(c2) from t1;
rollback;

##case arithmatic and basic compare
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0);
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0);
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0));

rollback;
update t1 set c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and ((v.c2 + 2 > 1) + 2 < 0));
select stddev(c2) from t1;
rollback;

##case should not be eliminated
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false));
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false));
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false)));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false)));

rollback;
update t1 set c2 = (select t2.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false)));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not(v.c2 and false)));
select stddev(c2) from t1;
rollback;

##case should not be eliminated
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false));
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false));
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false)));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false)));

rollback;
update t1 set c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false)));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (not((1 + 2 > v.c2) and false)));
select stddev(c2) from t1;
rollback;

##case should not be eliminated
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2);
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2);
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2));

rollback;
update t1 set c2 = (select t2.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (((1 + 2 > v.c2) and false) + 2 > -2));
select stddev(c2) from t1;
rollback;

##case arithmatic operator
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2);
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2);
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2));

rollback;
update t1 set c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > v.c2));
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null));
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null));
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null)));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null)));

rollback;
update t1 set c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null)));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select v.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */v.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null)));
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null));
--sorted_result
select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null));
insert into t1_temp (select * from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null)));

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null)));

rollback;
update t1 set c2 = (select t2.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null)));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t2 left join (select * from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null)));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join (select /*+ NO_REWRITE */* from t1) as v  on t2.c1 = v.c2 where (v.c2 is null) and (1 + 2 > (v.c2 is not null) and (v.c1 is not null)));
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 using(c1) where (t2.c1 is not null)=0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 is not null)=0;
insert into t3_temp (select * from t1 left join t2 using(c1) where (t2.c1 is not null)=0);

rollback;
insert into t3_temp (select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 is not null)=0);

rollback;
update t1 set c2 = (select t2.c1 from t1 left join t2 using(c1) where (t2.c1 is not null)=0);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t2.c1 from t1 left join t2 using(c1) where (t2.c1 is not null)=0);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t1 left join t2 using(c1) where (t2.c1 is not null)=0);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t1 left join t2 using(c1) where (t2.c1 is not null)=0);
select stddev(c2) from t1;
rollback;

##case:
--sorted_result
select * from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null);
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null);
insert into t3_temp (select * from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null));

rollback;
insert into t3_temp (select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t1 left join t2 using(c1) where (t2.c1 is not null) and (t2.c1 is null));
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0);
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0);
insert into t3_temp (select * from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0));

rollback;
insert into t3_temp (select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0));
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0));
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 using(c1) where (t2.c1 is null) and (t2.c1 > 0));
select stddev(c2) from t1;
rollback;

##case null and false     and parent is not and
--sorted_result
select * from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1;
insert into t3_temp (select * from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1);

rollback;
insert into t3_temp (select /*+ NO_REWRITE */* from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 using(c1) where (t2.c1 and false) < 1 + 1 limit 1);
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0;
insert into t1_temp (select * from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0);

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2) and 1 > 0);
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0;
insert into t1_temp (select * from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0);

rollback;
insert into t1_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where lnnvl(t2.c2 + 2 - 1) and 1 > 0);
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select c1 from t3 group by c2);
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select /*+ NO_REWRITE */c1 from t3 group by c2);
insert into t4_temp (select * from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select c1 from t3 group by c2));

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select /*+ NO_REWRITE */c1 from t3 group by c2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select c1 from t3 group by c2) and t2.c1=1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select /*+ NO_REWRITE */c1 from t3 group by c2) and t2.c1=1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select c1 from t3 group by c2) and t2.c1=1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 > t2.c1 where t2.c1 + 1 > all(select /*+ NO_REWRITE */c1 from t3 group by c2) and t2.c1=1);
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0;
insert into t5_temp (select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t2.c1 > 0 limit 1);
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1;
insert into t5_temp (select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where (case t2.c2 when 0 then 1 end) = 1);
select stddev(c2) from t1;
rollback;

## case
--sorted_result
select * from t1, t1 as v join t2 on v.c1 = t2.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1, t1 as v join t2 on v.c1 = t2.c1;
insert into t6_temp (select * from t1, t1 as v join t2 on v.c1 = t2.c1);

rollback;
insert into t6_temp (select /*+ NO_REWRITE */* from t1, t1 as v join t2 on v.c1 = t2.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1, t1 as v join t2 on v.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t1 as v join t2 on v.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t1 as v join t2 on v.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t1 as v join t2 on v.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2;
--sorted_result
select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2;
insert into t5_temp (select * from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2);

rollback;
update t1 set c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null;
insert into t7_temp (select * from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

##case resolver only support one joined table
#select * from t1 right join t2 on t1.c1 = t2.c1, t2 as v left join t3 on v.c2 = t3.c2 where t3.c2 is not null;
#select * from t1 right join t2 on t1.c1 = t2.c1, t2 as v, t3 where v.c2 = t3.c2 and t3.c2 is not null;

##case same table alias twice
--sorted_result
select * from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2;
--sorted_result
select /*+ NO_REWRITE */* from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2;
insert into t8_temp (select * from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2);

rollback;
insert into t8_temp (select /*+ NO_REWRITE */* from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2);

rollback;
update t1 set c2 = (select table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 or table1.c1 = table2.c2 limit 1);
select stddev(c2) from t1;
rollback;

##case same table alias twice
--sorted_result
select * from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2;
--sorted_result
select /*+ NO_REWRITE */* from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2;
insert into t8_temp (select * from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2);

rollback;
insert into t8_temp (select /*+ NO_REWRITE */* from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2);

rollback;
update t1 set c2 = (select table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */table1.c1 from t1 as table1 left join t1 as table2 on table1.c2 = table2.c1 where table1.c1 < table2.c1 and table1.c1 = table2.c2);
select stddev(c2) from t1;
rollback;

########################################################################
### null-reject satisfied

##case
--sorted_result
select * from t1 join (select * from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 join (select /*+ NO_REWRITE */* from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null;
insert into t5_temp (select * from t1 join (select * from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 join (select /*+ NO_REWRITE */* from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 join (select * from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join (select /*+ NO_REWRITE */* from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 join (select * from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join (select /*+ NO_REWRITE */* from t2) as v on t1.c1 = v.c1 left join t3 on t1.c1 = t3.c1 where t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null;
insert into t5_temp (select * from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t1.c1 = t3.c1 and t3.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

##case
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null;
insert into t5_temp (select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null;
insert into t5_temp (select * from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null);

rollback;
update t1 set c2 = (select t2.c1 from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t2.c1 from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t1, t2, t3 where t3.c1 is not null and t1.c2 = t3.c2 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null;
insert into t5_temp (select * from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 left join t3 on t1.c2 = t3.c2 where t3.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2;
insert into t5_temp (select * from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1, t3 where t3.c1 is not null and t1.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 join t2 on t1.c1 = t2.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1 join t2 on t1.c1 = t2.c1;
insert into t4_temp (select * from t1 join t2 on t1.c1 = t2.c1);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 join t2 on t1.c1 = t2.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1 = t2.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1 = t2.c1;
insert into t4_temp (select * from t1, t2 where t1.c1 = t2.c1);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1 = t2.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case can be eliminate
--sorted_result
select * from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1;
insert into t5_temp (select * from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1;
insert into t5_temp (select * from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1 = t2.c1 and t2.c1 = t3.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1;
insert into t4_temp (select * from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t2.c1 is not null and t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 on t1.c1>1 where t2.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1>1 where t2.c1 is not null;
insert into t4_temp (select * from t1 left join t2 on t1.c1>1 where t2.c1 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1>1 where t2.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1 > 1 and t2.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c1 is not null;
insert into t4_temp (select * from t1, t2 where t1.c1 > 1 and t2.c1 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null;
insert into t12_temp (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null;
insert into t12_temp (select t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 = t2.c1 and t1.c2 = t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;


#case
--sorted_result
select * from t1 inner join t2 on t1.c1>1 where t2.c3 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c3 is not null;
insert into t4_temp (select * from t1 inner join t2 on t1.c1>1 where t2.c3 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c3 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1 > 1 and t2.c3 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c3 is not null;
insert into t4_temp (select * from t1, t2 where t1.c1 > 1 and t2.c3 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c3 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 inner join t2 on t1.c1>1 where t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c2 is not null;
insert into t4_temp (select * from t1 inner join t2 on t1.c1>1 where t2.c2 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1 > 1 and t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c2 is not null;
insert into t4_temp (select * from t1, t2 where t1.c1 > 1 and t2.c2 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null;
insert into t4_temp (select * from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null;
insert into t4_temp (select * from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null;
insert into t12_temp (select t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c1 and t1.c2 = t2.c2 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null;
insert into t12_temp (select t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 and t1.c2=t2.c2 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 inner join t2 on t1.c1>1 where t2.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c1 is not null;
insert into t4_temp (select * from t1 inner join t2 on t1.c1>1 where t2.c1 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1 > 1 and t2.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c1 is not null;
insert into t4_temp (select * from t1, t2 where t1.c1 > 1 and t2.c1 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 inner join t2 on t1.c1>1 where t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c2 is not null;
insert into t4_temp (select * from t1 inner join t2 on t1.c1>1 where t2.c2 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1 > 1 and t2.c2 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c2 is not null;
insert into t4_temp (select * from t1, t2 where t1.c1 > 1 and t2.c2 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c2 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c2 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 inner join t2 on t1.c1>1 where t2.c3 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c3 is not null;
insert into t4_temp (select * from t1 inner join t2 on t1.c1>1 where t2.c3 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1>1 where t2.c3 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1>1 where t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1, t2 where t1.c1 > 1 and t2.c3 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c3 is not null;
insert into t4_temp (select * from t1, t2 where t1.c1 > 1 and t2.c3 is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1 > 1 and t2.c3 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1 > 1 and t2.c3 is not null limit 1);
select stddev(c2) from t1;
rollback;

################################################################################################################
#case
--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1;
insert into t5_temp (select * from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null;
insert into t10_temp (select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null);

rollback;
insert into t10_temp (select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1 is not null limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1;
insert into t12_temp (select t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1,t2,t3, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1;
insert into t7_temp (select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1;
insert into t10_temp (select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1);

rollback;
insert into t10_temp (select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1, t1 tt where t1.c1=t3.c1 and t1.c2=tt.c2 and t1.c1+t2.c1=tt.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100;
insert into t4_temp (select * from t1, t2 where t1.c1=t2.c1 limit 100);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1, t2 where t1.c1=t2.c1 limit 100);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select sum(c1), count(*) from t1 group by c2 order by c2 limit 100;
--sorted_result
select /*+ NO_REWRITE */sum(c1), count(*) from t1 group by c2 order by c2 limit 100;
insert into t11_temp (select sum(c1), count(*) from t1 group by c2 order by c2 limit 100);

rollback;
insert into t11_temp (select /*+ NO_REWRITE */sum(c1), count(*) from t1 group by c2 order by c2 limit 100);

rollback;
update t1 set c2 = (select sum(c1) from t1 group by c2 order by c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */sum(c1) from t1 group by c2 order by c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select sum(c1) from t1 group by c2 order by c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */sum(c1) from t1 group by c2 order by c2 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select c1 from t1 as t order by c1;
--sorted_result
select /*+ NO_REWRITE */c1 from t1 as t order by c1;
insert into t12_temp (select c1 from t1 as t order by c1);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */c1 from t1 as t order by c1);

rollback;
update t1 set c2 = (select c1 from t1 as t order by c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */c1 from t1 as t order by c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select c1 from t1 as t order by c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */c1 from t1 as t order by c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3;
--sorted_result
select /*+ NO_REWRITE */* from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3;
insert into t13_temp (select * from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3);

rollback;
insert into t13_temp (select /*+ NO_REWRITE */* from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3);

rollback;
update t1 set c2 = (select t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3;
insert into t12_temp (select t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3);

rollback;
update t1 set c2 = (select t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1,t2,t3 where t1.c1=t3.c1 and t1.c2=t2.c2 and t2.c3=t3.c3 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1;
insert into t7_temp (select * from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 t on t1.c1=t.c1,t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where false;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1=t2.c1 where false;
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where false);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1=t2.c1 where false);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where false limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where false limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where false limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where false limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1;
insert into t4_temp (select * from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1>1 where t2.c1 is null and t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 right join t2 on t1.c1 = t2.c2;
--sorted_result
select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c2;
insert into t4_temp (select * from t1 right join t2 on t1.c1 = t2.c2);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c2);

rollback;
update t1 set c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 inner join t2 on t1.c1 = t2.c2;
--sorted_result
select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1 = t2.c2;
insert into t4_temp (select * from t1 inner join t2 on t1.c1 = t2.c2);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 inner join t2 on t1.c1 = t2.c2);

rollback;
update t1 set c2 = (select t1.c1 from t1 inner join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 inner join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 inner join t2 on t1.c1 = t2.c2 limit 1);
select stddev(c2) from t1;
rollback;

## case
--sorted_result
select c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 100;
--sorted_result
select /*+ NO_REWRITE */c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 100;
insert into t12_temp (select c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 100);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 100);

rollback;
update t1 set c2 = (select c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */c1 from t1 where c1 > 0 and c2 < 0 order by c2 limit 1);
select stddev(c2) from t1;
rollback;

## case  join
--sorted_result
select t1.c1 from t1, t2 limit 100;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1, t2 limit 100;
insert into t12_temp (select t1.c1 from t1, t2 limit 100);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1, t2 limit 100);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 limit 1);
select stddev(c2) from t1;
rollback;

## case  join with predicate
--sorted_result
select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100;
insert into t12_temp (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 ;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 ;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 = t2.c1 );

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1  limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1  limit 1);
select stddev(c2) from t1;
rollback;

#case  join with predicate
--sorted_result
select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100;
insert into t12_temp (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 100);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2 where t1.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

#case  3-table join
--sorted_result
select t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1;
insert into t12_temp (select t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1);

rollback;
update t1 set c2 = (select t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1, t2, t3 where t1.c1=t2.c1 and t1.c2>t2.c2 and t2.c3=t3.c3 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3;
--sorted_result
select /*+ NO_REWRITE */* from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3;
insert into t13_temp (select * from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3);

rollback;
insert into t13_temp (select /*+ NO_REWRITE */* from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3);

rollback;
update t1 set c2 = (select t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t2.c1 from t2 left join t3 on t2.c1=t3.c1 and t2.c2<t3.c2 where t2.c3>t3.c3 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1;
--sorted_result
select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1;
insert into t12_temp (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1);

rollback;
insert into t12_temp (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c2>1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1;
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1);

rollback;
insert into t4_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 and t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;

#case
--sorted_result
select * from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2;
--sorted_result
select /*+ NO_REWRITE */* from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2;
insert into t5_temp (select * from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2);

rollback;
update t1 set c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t1.c2 where t2.c2 = 1;
--sorted_result
select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t1.c2 where t2.c2 = 1;
insert into t5_temp (select * from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2);

rollback;
update t1 set c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 join t2 on t1.c1 = t2.c1 join t3 on t2.c2 = t3.c2 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1;
--sorted_result
select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1;
insert into t5_temp (select * from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1);

rollback;
update t1 set c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t2.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1;
--sorted_result
select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1;
insert into t5_temp (select * from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1);

rollback;
insert into t5_temp (select /*+ NO_REWRITE */* from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1);

rollback;
update t1 set c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join t2 on t1.c1 = t2.c1 right join t3 on t3.c2 = t2.c2 where t1.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3);
--sorted_result
select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3);
insert into t11_temp (select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3));

rollback;
insert into t11_temp (select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3));

rollback;
update t1 set c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3);
--sorted_result
select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3);
insert into t11_temp (select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3));

rollback;
insert into t11_temp (select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3));

rollback;
update t1 set c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, 3) limit 1);
select stddev(c2) from t1;
rollback;

# should not do rewrite
--sorted_result
select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2);
--sorted_result
select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2);
insert into t11_temp (select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2));

rollback;
insert into t11_temp (select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2));

rollback;
update t1 set c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 as a1  from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t1.c2 in (1, 2, t2.c2) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL);
--sorted_result
select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL);
insert into t11_temp (select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL));

rollback;
insert into t11_temp (select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL));

rollback;
update t1 set c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL);
--sorted_result
select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL);
insert into t11_temp (select t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL));

rollback;
insert into t11_temp (select /*+ NO_REWRITE */t1.c1 as a1, t2.c1 as a2 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL));

rollback;
update t1 set c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 as a1 from t1 left join t2 on t1.c1 != t2.c1 where t2.c2 not in (1, 2, NULL) limit 1);
select stddev(c2) from t1;
rollback;

# left-deep
--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 != t2.c1 left join t3 on t1.c1 != t3.c1 left join t4 on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

# bushy
--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 != t2.c1) left join (t3 left join t4 on t4.c1 != t3.c1) on t1.c1 != t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

## case full outer join el
# case
--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 full join t2 on t1.c1 = t2.c1) left join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

# case
--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 is NULL and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 is NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 is NULL and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 IS NULL limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
--sorted_result
select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0;
insert into t7_temp (select * from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
insert into t7_temp (select /*+ NO_REWRITE */* from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1 = t2.c1) full join (t3 left join t4 on t4.c1 = t3.c1) on t1.c1 = t4.c1 where t2.c1 = 0 and t3.c1 = 0 and t4.c1 = 0 limit 1);
select stddev(c2) from t1;
rollback;

# 可以消除外连接的情况
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2);
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2));

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where abs(t2.c2) > 2 or sqrt(t2.c2) > 2 or log2(t2.c2) > 2 or (t2.c2 xor t2.c1 > 2) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or t2.c2 < 1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 is true limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1);
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1));

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > any (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000);
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000));

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 != any (select c2 from t1 where c2 > 1000) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2);
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2));

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (t2.c2 not between 1 and 4) or (t2.c2 between 3 and 3) or (t2.c2 like 2) limit 1);
select stddev(c2) from t1;
rollback;

# 空值传递 expr is true
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;

# 空值拒绝 expr is true
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is true limit 1);
select stddev(c2) from t1;
rollback;

# 空值传递 expr is false
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;

# 空值传递 expr is not null
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c2 > 2) or (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;

# 不可以消除的情况

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4);
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4));

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (3 not between t2.c2 and 4) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1);
--sorted_result
select /*+ NO_REWRITE */ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1));

rollback;
insert into t4_temp (select /*+ NO_REWRITE */ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */ t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */ t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > 4 or nvl(t2.c2, 1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end);
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end));

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where (case t2.c2 when 0 then 1 else 0 end) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1);
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1);
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1));

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where t2.c2 > all (select c2 from t1) limit 1);
select stddev(c2) from t1;
rollback;

# 空值拒绝 expr is false
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is false limit 1);
select stddev(c2) from t1;
rollback;

# 空值拒绝 expr is not null
--sorted_result
select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null;
--sorted_result
select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null;
insert into t4_temp (select * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null);

rollback;
insert into t4_temp (select /*+ NO_REWRITE*/ * from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1 = t2.c1 where ((t2.c1 > 2) and (t2.c2 < 4)) is not null limit 1);
select stddev(c2) from t1;
rollback;

set autocommit=1;

--disable_warnings
drop table if exists t1, t2, t3, t4, t5, t6;
drop table t1_temp, t2_temp, t3_temp, t4_temp, t5_temp, t6_temp, t7_temp, t8_temp, t9_temp, t10_temp, t11_temp, t12_temp, t13_temp, t14_temp, t15_temp;
--enable_warnings
create table t1 (c1 int, c2 int);
create table t2 (c1 int, c2 int);
create table t3 (c1 int, c2 int);
create table t4 (c1 int, c2 int);
create table t5 (c1 int, c2 int);
create table t6 (c1 int, c2 int);

create table t1_temp(a int, b int, d int, e int);
create table t2_temp(a int, b int);
create table t3_temp(a int, b int, c int);
create table t4_temp(a int, b int, c int, d int); 
create table t5_temp(a int, b int, c int, d int, f int, g int); 
create table t6_temp(a int, b int, c int, d int, e int, f int);
create table t7_temp(a int, b int, c int, d int, f int, g int, i int, j int);
create table t8_temp(a int, b int, c int, d int);
create table t9_temp(a int, b int, c int, d int, f int, g int, i int, j int);
create table t10_temp(a int, b int, c int, d int, f int, g int, i int, j int, l int, m int);
create table t11_temp(a int, b int);
create table t12_temp(a int);
create table t13_temp(a int, b int, d int, e int); 
create table t14_temp(a int, b int, c int);
create table t15_temp(a int, b int, c int, d int, f int, g int, i int, j int, l int, m int);

--disable_query_log
insert/**/ into t2 values (1, 1);
insert/**/ into t3 values (1, 1);
--enable_query_log

set autocommit=0;

select * from t1 right join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1;
select /*+NO_REWRITE*/ * from t1 right join t2 on t1.c1 = t2.c1 join t3 on t2.c1 = t3.c1;

## t1 is the right table for outer join,
## subquery unnest will add a invalid-null-reject condition: t3.c2 = t1.c2
select * from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2);
select /*+NO_REWRITE*/ * from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2);
insert into t1_temp (select * from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2));

rollback;
insert into t1_temp (select /*+NO_REWRITE*/ * from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2));

rollback;
update t1 set c2 = (select t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+NO_REWRITE*/t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+NO_REWRITE*/t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where not exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;

select * from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2);
select /*+NO_REWRITE*/ * from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2);
insert into t1_temp (select * from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2));

rollback;
insert into t1_temp (select /*+NO_REWRITE*/ * from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2));

rollback;
update t1 set c2 = (select t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+NO_REWRITE*/t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+NO_REWRITE*/t1.c1 from t2 left join t1 on t1.c1 = t2.c1 where exists (select 1 from t3 where t3.c2 = t1.c2) limit 1);
select stddev(c2) from t1;
rollback;

set autocommit=1;

# eliminate outer join in semi info joined table.

--disable_query_log
insert into t1 values(1, 1);
insert into t1 values(null, 1);
insert into t1 values(5, 5);
insert into t1 values(null, 5);
insert into t1 values(10, 10);
insert into t1 values(2, 2);
insert into t1 values(3, 2);
insert into t1 values(4, 2);
insert into t2 values(2, 2);
insert into t2 values(null, 2);
insert into t2 values(6, 6);
insert into t2 values(null, 6);
insert into t2 values(null, null);
insert into t2 values(1, 1);
insert into t2 values(3, 3);
insert into t2 values(4, 4);
insert into t3 values(3, 3);
insert into t3 values(null, 3);
insert into t3 values(7, 7);
insert into t3 values(null, 7);
insert into t3 values(7, 7);
insert into t3 values(4, 4);
insert into t3 values(5, 5);
insert into t4 values(4, 4);
insert into t4 values(null, 4);
insert into t4 values(8, 8);
insert into t4 values(null, 8);
insert into t4 values(8, 8);
insert into t4 values(1, 1);
insert into t4 values(2, 2);
insert into t4 values(3, 3);
insert into t5 values(1, 1);
insert into t5 values(2, 2);
insert into t5 values(3, 3);
insert into t5 values(4, 4);
insert into t5 values(null, null);
insert into t6 values(1, null);
insert into t6 values(2, null);
insert into t6 values(3, null);
insert into t6 values(4, null);
insert into t6 values(5, null);
--enable_query_log

--disable_query_log
--disable_result_log
select * from t1;
select * from t2;
select * from t3;
select * from t4;
select * from t5;
select * from t6;
--enable_query_log
--enable_result_log

set autocommit=0;

#单层
--sorted_result
select * from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1);
--sorted_result
select /*+no_rewrite*/* from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1);
insert into t11_temp (select * from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1));

rollback;
insert into t11_temp (select /*+no_rewrite*/* from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1));

rollback;
update t1 set c2 = (select t1.c1 from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+no_rewrite*/t1.c1 from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+no_rewrite*/t1.c1 from t1 where (11) in (select t3.c1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1 = 1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1); #满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1); #不满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1); #满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1);
insert into t11_temp (select * from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1));

rollback;
insert into t11_temp (select /*+NO_REWRITE*/* from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1); #不满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1);
insert into t11_temp (select * from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1));

rollback;
insert into t11_temp (select /*+NO_REWRITE*/* from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1); #满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1);
insert into t11_temp (select * from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1));

rollback;
insert into t11_temp (select /*+NO_REWRITE*/* from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1); #不满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1);
insert into t11_temp (select * from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1));

rollback;
insert into t11_temp (select /*+NO_REWRITE*/* from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where not exists (select 1 from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t2.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1); #anti性质
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2); #不可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2); #不可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t1.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2); #可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2); #不可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where t2.c1 not in (select t3.c1 from t3 limit 2) limit 1);
select stddev(c2) from t1;
rollback;

#单层joined table 混合
--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1); #左右表都满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1); #右表不满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c1=t3.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1); #左表不满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2); #性质+右表满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t4.c2) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2); #性质+右表不满足空值拒绝
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c2 where t2.c2=t3.c2) limit 1);
select stddev(c2) from t1;
rollback;

#多层semi 
--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1); #t1/t2可改，含有空值拒绝t2.c2=t4.c2，t3/t4可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1); 
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1); #均不可改，无空值拒绝条件
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t1.c2=t3.c2) and not exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1); #t1/t2在not前不可改，但是t2.c1=t5.c1可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 left join t4 on t3.c1=t4.c1 where t2.c2=t4.c2) and exists (select 1 from t5 left join t6 on t5.c1=t6.c1 where t2.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)); #t5/t6可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1));
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)); #t3/t4可改，t5/t6可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1));
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists( select null from t3 left join t4 on t3.c1=t4.c1 where t1.c1=t4.c1 and exists(select null from t5 left join t6 on t5.c1=t6.c1 where t1.c1=t6.c1)) limit 1);
select stddev(c2) from t1;
rollback;

#验证semi/anti condition条件
--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5);
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5);
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1<5) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5);
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5);
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select 1 from t3 where t2.c1+t3.c1 = 5) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 where not exists (select null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100);
--sorted_result
select /*+NO_REWRITE*/* from t1 where not exists (select /*+NO_REWRITE*/null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100);
insert into t11_temp (select * from t1 where not exists (select null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100));

rollback;
insert into t11_temp (select /*+NO_REWRITE*/* from t1 where not exists (select /*+NO_REWRITE*/null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100));

rollback;
update t1 set c2 = (select t1.c1 from t1 where not exists (select null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where not exists (select /*+NO_REWRITE*/null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 where not exists (select null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 where not exists (select /*+NO_REWRITE*/null from t2 left join t3 on t2.c1=t3.c1 where t1.c1=t3.c1 and t2.c1=100) limit 1);
select stddev(c2) from t1;
rollback;

#增强joined table中的on condition的改写
#on condition 普通
--sorted_result
select t1.c2, t2.c2, t3.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1;
--sorted_result
select /*+NO_REWRITE*/t1.c2, t2.c2, t3.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1;
insert into t14_temp (select t1.c2, t2.c2, t3.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1);

rollback;
insert into t14_temp (select /*+NO_REWRITE*/t1.c2, t2.c2, t3.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1);

rollback;
update t1 set c2 = (select t1.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+NO_REWRITE*/t1.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+NO_REWRITE*/t1.c2 from t1 left join (t2 left join t3 on t2.c1 = t3.c1) on t1.c1 = 1 and t2.c1 = 1 and t3.c1 = 1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1;
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1;
insert into t5_temp (select * from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1);

rollback;
insert into t5_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1 and t2.c2=1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1;
--sorted_result
select /*+NO_REWRITE*/* from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1;
insert into t5_temp (select * from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1);

rollback;
insert into t5_temp (select /*+NO_REWRITE*/* from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join t3 on t2.c1=t3.c1) on t1.c1=t3.c1 and t3.c2 = 1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1; ##不能消除，条件都处于右枝
--sorted_result
select /*+NO_REWRITE*/* from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1;
insert into t5_temp (select * from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1);

rollback;
insert into t5_temp (select /*+NO_REWRITE*/* from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1);

rollback;
update t1 set c2 = (select t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1; #消除之后再消除
--sorted_result
select /*+NO_REWRITE*/* from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1;
insert into t5_temp (select * from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1);

rollback;
insert into t5_temp (select /*+NO_REWRITE*/* from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1);

rollback;
update t1 set c2 = (select t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 right join (t2 left join t3 on t2.c1=t3.c1) on t2.c1=1 and t3.c1=1 where t1.c1>1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1; #左边不改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1;
insert into t5_temp (select * from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1);

rollback;
insert into t5_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t3 on t2.c1=t3.c1 and t2.c1>1 limit 1);
select stddev(c2) from t1;
rollback;

#on condition 祖父
--sorted_result
select * from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1; #不能改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1;
insert into t7_temp (select * from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 inner join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1; #不能改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1;
insert into t7_temp (select * from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t4.c1=t2.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1; #可以改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1;
insert into t7_temp (select * from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1; #不能改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1; #不能改
insert into t7_temp (select * from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t1.c1=t3.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0;
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0;
insert into t7_temp (select * from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=1 left join t3 on t1.c1=t3.c1 left join t4 on t1.c1>1 and t3.c1>1 where t3.c1>0 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1;
--sorted_result
select /*+NO_REWRITE*/* from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1;
insert into t7_temp (select * from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1);

rollback;
update t1 set c2 = (select t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join (t2 left join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t3.c1) on t3.c1>1 where t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;

#on condition bushy tree
--sorted_result
select * from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1; #右侧可改
--sorted_result
select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1;
insert into t7_temp (select * from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1) left join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1; #不可改
--sorted_result
select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1; #不可改
insert into t7_temp (select * from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1) full join (t3 left join t4 on t3.c1=t4.c1) on t1.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1;
--sorted_result
select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1;
insert into t7_temp (select * from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1);

rollback;
insert into t7_temp (select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1) inner join (t3 left join t4 on t3.c1=t4.c1) on t2.c1=t4.c1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1;
--sorted_result
select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1;
insert into t15_temp (select * from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1);

rollback;
insert into t15_temp (select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) left join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1;
--sorted_result
select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1;
insert into t15_temp (select * from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1);

rollback;
insert into t15_temp (select /*+NO_REWRITE*/* from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1);

rollback;
update t1 set c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from (t1 left join t2 on t1.c1=t2.c1 left join t3 on t1.c1=t3.c1) right join (t4 left join t5 on t4.c1=t5.c1) on t1.c1>1 and t2.c1>1 and t3.c1>1 limit 1);
select stddev(c2) from t1;
rollback;

#on condition semi join
--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1); #左测可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1);
insert into t5_temp (select * from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1));

rollback;
insert into t5_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 right join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1); #左侧不可改
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1);
insert into t5_temp (select * from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1));

rollback;
insert into t5_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 left join t5 on t2.c1=t5.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 where t3.c1>1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1);
--sorted_result
select /*+NO_REWIRTE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1));

rollback;
insert into t4_temp (select /*+NO_REWIRTE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+NO_REWIRTE*/t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+NO_REWIRTE*/t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1);
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t4.c1 where t1.c1=1) limit 1);
select stddev(c2) from t1;
rollback;

--sorted_result
select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1);
--sorted_result
select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1);
insert into t4_temp (select * from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1));

rollback;
insert into t4_temp (select /*+NO_REWRITE*/* from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1));

rollback;
update t1 set c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
update t1 set c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;
delete from t1 where c2 = (select /*+ NO_REWRITE */t1.c1 from t1 left join t2 on t1.c1=t2.c1 where not exists (select null from t3 left join t4 on t3.c1=t4.c1 left join t5 on t3.c1=t5.c1 where t1.c1=t5.c1) limit 1);
select stddev(c2) from t1;
rollback;

set autocommit=1;

# schema
--disable_warnings
drop table if exists t5, t6, t7, t8, t9, t10, t11;
--enable_warnings

#单列主键
create table t5(c1 int primary key, c2 int, c3 varchar(32));
#多主列主键
create table t6(c1 int, c2 int, c3 varchar(32), primary key(c1,c2));
#主键分区表
create table t7(c1 int primary key, c2 int, c3 varchar(32))
                                partition by hash(c1) partitions 5;
#单列外键
create table t8(c1 int, c2 int not null, c3 varchar(32),
                foreign key(c1) references t5(c1),
                foreign key(c2) references t5(c1));
#单列外键分区表
create table t9(c1 int not null, c2 int, c3 varchar(32),
                foreign key(c1) references t7(c1))
                partition by list(c1) (
                    partition p0 values in(1,2),
                    partition p1 values in(3,4),
                    partition p2 values in(5,6),
                    partition p3 values in(7,8),
                    partition p4 values in(9,10));
#单列外键分区表
create table t10(c1 int not null, c2 int, c3 varchar(32),
                foreign key(c1) references t7(c1))
                partition by hash(c1) partitions 5;
#多列外键
create table t11(c1 int not null, c2 int not null, c3 varchar(32),
            foreign key(c1,c2) references t6(c1,c2));

--disable_query_log
insert into t5 values (1, 1, 'a');
insert into t5 values (2, 5, 'b');
insert into t5 values (3, 5, 'c');
insert into t5 values (4, 6, 'd');
insert into t5 values (5, 7, 'e');
insert into t5 values (6, 8, 'f');

insert into t6 values (1, 1, 'a');
insert into t6 values (2, 2, 'b');
insert into t6 values (3, 3, 'c');
insert into t6 values (4, 4, 'd');
insert into t6 values (5, 5, 'e');
insert into t6 values (6, 6, 'f');

insert into t7 values (1, 1, 'a');
insert into t7 values (2, 5, 'b');
insert into t7 values (3, 5, 'c');
insert into t7 values (4, 6, 'd');
insert into t7 values (5, 7, 'e');
insert into t7 values (6, 8, 'f');

insert into t8 values (1, 1, 'a');
insert into t8 values (1, 2, 'b');
insert into t8 values (3, 3, 'c');
insert into t8 values (3, 3, 'd');
insert into t8 values (null, 4, 'e');
insert into t8 values (null, 4, 'f');

insert into t9 values (1, 2, 'a');
insert into t9 values (1, 2, 'b');
insert into t9 values (3, 3, 'c');
insert into t9 values (3, 3, 'd');
insert into t9 values (4, 4, 'e');
insert into t9 values (4, 4, 'f');

insert into t10 values (1, 2, 'a');
insert into t10 values (1, 2, 'b');
insert into t10 values (3, 3, 'c');
insert into t10 values (3, 3, 'd');
insert into t10 values (4, 4, 'e');
insert into t10 values (4, 4, 'f');

insert into t11 values (1, 1, 'a');
insert into t11 values (1, 1, 'b');
insert into t11 values (3, 3, 'c');
insert into t11 values (3, 3, 'd');
insert into t11 values (4, 4, 'e');
insert into t11 values (4, 4, 'f');
--enable_query_log

--disable_query_log
--disable_result_log
select count(*) from t5;
select count(*) from t6;
select count(*) from t7;
select count(*) from t8;
select count(*) from t9;
select count(*) from t10;
select count(*) from t11;
--enable_query_log
--enable_result_log
# schema END

set autocommit=0;

##cases 增强功能，根据主外键消除外连接
##case 简单主外键连接
--sorted_result
##外键没有非空约束，不能消除
select * from t8 a left join t5 b on a.c1=b.c1;
--sorted_result
##左表为父表，不能消除
select * from t8 a right join t5 b on a.c2=b.c1;
--sorted_result
##主键在generated table中，不能消除
select * from t8 a left join (select * from t5 where t5.c1>0) b on a.c2=b.c1;
--sorted_result
##主键在generated table中，不能消除
select * from (select * from t8 where t8.c1>0) a left join (select * from t5 where t5.c1>0) b on a.c2=b.c1;
--sorted_result
##非等值连接，不能消除
select * from t8 a left join t5 b on a.c2>b.c1;
--sorted_result
##含有非主外键连接条件，不能消除
select * from t8 a left join t5 b on a.c2=b.c1 and a.c1<3;
##on condition有重复expr
--sorted_result
select * from t8 a left join t5 b on a.c2=b.c1 and a.c2=b.c1 and a.c2=b.c1;
--sorted_result
select * from t8 a left join t5 b on a.c2=b.c1;
--sorted_result
select /*+NO_REWRITE*/* from t8 a left join t5 b on a.c2=b.c1;
insert into t16_temp (select * from t8 a left join t5 b on a.c2=b.c1);
rollback;
insert into t16_temp (select /*+NO_REWRITE*/ * from t8 a left join t5 b on a.c2=b.c1);
rollback;
update t5 set c2 = (select a.c1 from t8 a left join t5 b on a.c2=b.c1 limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c1 from t8 a left join t5 b on a.c2=b.c1 limit 1);
select stddev(c2) from t5;
rollback;

--sorted_result
select * from t8 a left join t5 b on a.c1=b.c1 where a.c1>0;
--sorted_result
select /*+NO_REWRITE*/* from t8 a left join t5 b on a.c1=b.c1 where a.c1>0;
insert into t16_temp (select * from t8 a left join t5 b on a.c1=b.c1 where a.c1>0);
rollback;
insert into t16_temp (select /*+NO_REWRITE*/ * from t8 a left join t5 b on a.c1=b.c1 where a.c1>0);
rollback;
update t5 set c2 = (select a.c1 from t8 a left join t5 b on a.c1=b.c1 where a.c1>0 limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c1 from t8 a left join t5 b on a.c1=b.c1 where a.c1>0 limit 1);
select stddev(c2) from t5;
rollback;

##case 多列主外键连接
##主外键没有一一对应连接，不能消除
--sorted_result
select * from t11 a left join t6 b on a.c1=b.c2 and a.c2=b.c1;
--sorted_result
select * from t11 a left join t6 b on a.c1=b.c1 and a.c2=b.c2;
--sorted_result
select /*+NO_REWRITE*/* from t11 a left join t6 b on a.c1=b.c1 and a.c2=b.c2;
insert into t16_temp (select * from t11 a left join t6 b on a.c1=b.c1 and a.c2=b.c2);
rollback;
insert into t16_temp (select /*+NO_REWRITE*/ * from t11 a left join t6 b on a.c1=b.c1 and a.c2=b.c2);
rollback;
update t5 set c2 = (select a.c1 from t11 a left join t6 b on a.c1=b.c1 and a.c2=b.c2 limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c1 from t11 a left join t6 b on a.c1=b.c1 and a.c2=b.c2 limit 1);
select stddev(c2) from t5;
rollback;

##case 分区表的主外键连接
--sorted_result
##父表有partition hint，不能消除
select * from t10 partition(p1) a left join t7 partition(p1) b on a.c1=b.c1;
--sorted_result
select * from t10 partition(p1) a left join t7 b on a.c1=b.c1;
--sorted_result
select /*+NO_REWRITE*/ * from t10 partition(p1) a left join t7 b on a.c1=b.c1;
insert into t16_temp (select * from t10 partition(p1) a left join t7 b on a.c1=b.c1);
rollback;
insert into t16_temp (select /*+NO_REWRITE*/ * from t10 partition(p1) a left join t7 b on a.c1=b.c1);
rollback;
update t5 set c2 = (select a.c1 from t10 partition(p1) a left join t7 b on a.c1=b.c1 limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c1 from t10 partition(p1) a left join t7 b on a.c1=b.c1 limit 1);
select stddev(c2) from t5;
rollback;

--sorted_result
select * from t8 a full join t5 b on a.c2=b.c1;
--sorted_result
select /*+NO_REWRITE*/* from t8 a full join t5 b on a.c2=b.c1;
insert into t16_temp (select * from t8 a full join t5 b on a.c2=b.c1);
rollback;
insert into t16_temp (select /*+NO_REWRITE*/ * from t8 a full join t5 b on a.c2=b.c1);
rollback;
update t5 set c2 = (select a.c1 from t8 a full join t5 b on a.c2=b.c1 limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c1 from t8 a full join t5 b on a.c2=b.c1 limit 1);
select stddev(c2) from t5;
rollback;

--sorted_result
select * from t5 b right join t8 a on a.c2=b.c1;
--sorted_result
select /*+NO_REWRITE*/* from t5 b right join t8 a on a.c2=b.c1;
insert into t16_temp (select * from t5 b right join t8 a on a.c2=b.c1);

rollback;
insert into t16_temp (select /*+NO_REWRITE*/ * from t5 b right join t8 a on a.c2=b.c1);
rollback;
update t5 set c2 = (select a.c1 from t5 b right join t8 a on a.c2=b.c1 limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c1 from t5 b right join t8 a on a.c2=b.c1 limit 1);
select stddev(c2) from t5;
rollback;

--sorted_result
select * from t8 a full join t5 b on a.c2=b.c1 where a.c1 is not null;
--sorted_result
select /*+NO_REWRITE*/* from t8 a full join t5 b on a.c2=b.c1 where a.c1 is not null;
insert into t16_temp (select * from t8 a full join t5 b on a.c2=b.c1 where a.c1 is not null);

rollback;
insert into t16_temp (select /*+NO_REWRITE*/ * from t8 a full join t5 b on a.c2=b.c1 where a.c1 is not null);
rollback;
update t5 set c2 = (select a.c1 from t8 a full join t5 b on a.c2=b.c1 where a.c1 is not null limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c1 from t8 a full join t5 b on a.c2=b.c1 where a.c1 is not null limit 1);
select stddev(c2) from t5;
rollback;

--sorted_result
select * from (select t5.c2 from t8 left join t5 on t5.c1=t8.c2) a full join (select t8.c2 from t8 left join t5 on t8.c1=t5.c1 where t5.c2 is not null) b on a.c2 = b.c2;
--sorted_result
select /*+NO_REWRITE*/* from (select /*+NO_REWRITE*/t5.c2 from t8 left join t5 on t5.c1=t8.c2) a full join (select /*+NO_REWRITE*/t8.c2 from t8 left join t5 on t8.c1=t5.c1 where t5.c2 is not null) b on a.c2 = b.c2;
insert into t11_temp (select * from (select t5.c2 from t8 left join t5 on t5.c1=t8.c2) a full join (select t8.c2 from t8 left join t5 on t8.c1=t5.c1 where t5.c2 is not null) b on a.c2 = b.c2);
rollback;
insert into t11_temp (select /*+NO_REWRITE*/ * from (select /*+NO_REWRITE*/t5.c2 from t8 left join t5 on t5.c1=t8.c2) a full join (select /*+NO_REWRITE*/t8.c2 from t8 left join t5 on t8.c1=t5.c1 where t5.c2 is not null) b on a.c2 = b.c2);
rollback;
update t5 set c2 = (select a.c2 from (select t5.c2 from t8 left join t5 on t5.c1=t8.c2) a full join (select t8.c2 from t8 left join t5 on t8.c1=t5.c1 where t5.c2 is not null) b on a.c2 = b.c2 limit 1);
select stddev(c2) from t5;
rollback;
update t5 set c2 = (select /*+NO_REWRITE*/ a.c2 from (select /*+NO_REWRITE*/t5.c2 from t8 left join t5 on t5.c1=t8.c2) a full join (select /*+NO_REWRITE*/t8.c2 from t8 left join t5 on t8.c1=t5.c1 where t5.c2 is not null) b on a.c2 = b.c2 limit 1);
select stddev(c2) from t5;
rollback;

set autocommit=1;

# drop schema
--disable_warnings
drop table if exists t11, t10, t9, t8, t7, t6, t5;
--enable_warnings

insert into t4_temp(select * from t1 left join t2 on t1.c1=t2.c1);
--disable_query_log
--disable_result_log
select count(*) from t4_temp;
--enable_query_log
--enable_result_log
--error 1241
delete from t4_temp where a = (select t1.c1, t1.c2 from t1 left join t2 on t1.c1=t2.c1 limit 1);
delete from t4_temp where a = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 limit 1);
delete from t4_temp where (a, b) = (select t1.c1, t1.c2 from t1 left join t2 on t1.c1=t2.c1 limit 1);
--error 1241
delete from t4_temp where (a, b) = (select t1.c1, t1.c2, t2.c1 from t1 left join t2 on t1.c1=t2.c1 limit 1);
select stddev(a) from t4_temp;
--error 1241
update t4_temp set a = (select t1.c1, t1.c2 from t1 left join t2 on t1.c1=t2.c1 limit 1);
update t4_temp set a = (select t1.c1 from t1 left join t2 on t1.c1=t2.c1 limit 1);
select stddev(a) from t4_temp;

drop table if exists t1_temp, t2_temp, t3_temp, t4_temp, t5_temp, t6_temp, t7_temp, t8_temp, t9_temp, t10_temp, t11_temp, t12_temp, t13_temp, t14_temp, t15_temp, t16_temp;
drop database transformer;
#alter system set _enable_record_rollback_trans_log=true;
